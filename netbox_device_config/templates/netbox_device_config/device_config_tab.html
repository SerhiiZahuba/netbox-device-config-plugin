{% extends 'dcim/device/base.html' %}
{% load static %}

{% block content %}
<div class="container-fluid">

    <!-- Header -->
    <div class="row mb-3">
        <div class="col">
            <h2 class="h4">
                <i class="mdi mdi-file-code-outline"></i> Config History – {{ object.name }}
            </h2>
            <small class="text-muted">
                Config ID: {{ latest.id|default:"—" }} • Versions: {{ history|length }}
            </small>
        </div>
    </div>

    <div class="row">
        <!-- Left column -->
        <div class="col-md-3">
            <div class="card">
                <div class="card-header fw-bold">Config Versions</div>
                <div class="list-group list-group-flush">
                    {% for conf in history %}
                    <a href="#"
                       hx-get="{% url 'plugins:netbox_device_config:view_config' conf.id %}"
                       hx-target="#config-content"
                       hx-swap="innerHTML"
                       class="list-group-item list-group-item-action">
                        <div class="d-flex justify-content-between align-items-center">
                            <span><i class="mdi mdi-file"></i> v{{ forloop.revcounter }}</span>
                            <small class="text-muted">{{ conf.created_at|date:"Y-m-d H:i" }}</small>
                        </div>
                        <small class="text-muted">{{ conf.config|length }} bytes</small>
                    </a>
                    {% empty %}
                    <div class="list-group-item text-muted">No configs yet.</div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <!-- Right column -->
        <div class="col-md-9">
            <div id="config-content">
                {% include "netbox_device_config/config_content.html" with conf=latest %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
